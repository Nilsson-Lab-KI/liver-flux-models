(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26979,        649]
NotebookOptionsPosition[     22664,        534]
NotebookOutlinePosition[     23037,        550]
CellTagsIndexPosition[     22994,        547]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Export liver model in Openflux format", "Title",
 CellChangeTimes->{{3.688985168803664*^9, 3.68898517086083*^9}, {
  3.688985321901182*^9, 3.6889853250456843`*^9}, {3.8569305317650423`*^9, 
  3.8569305384379516`*^9}, {3.8732783325899277`*^9, 
  3.873278338833847*^9}},ExpressionUUID->"5a16511f-8798-4118-97b0-\
a3784717dfa2"],

Cell["\<\
Write out a metabolic network and atom map model in Openflux text format.\
\>", "Text",
 CellChangeTimes->{{3.8732783402027225`*^9, 3.873278380871526*^9}, {
  3.8736005646334295`*^9, 
  3.8736005891651216`*^9}},ExpressionUUID->"ff575bd2-4f28-444b-9d35-\
3f8588b72669"],

Cell["\<\
NOTE: This notebook fetches the model to export from the Nilsson lab \
database.  A database account is required to run this script.\
\>", "Text",
 CellChangeTimes->{{3.873792986003321*^9, 
  3.873793036235998*^9}},ExpressionUUID->"627f5246-9c2b-4e7d-a06b-\
3a7c721831e0"],

Cell[BoxData[{
 RowBox[{"<<", "NilssonLab`MetabolicNetwork`"}], "\n", 
 RowBox[{"<<", "NilssonLab`AtomMap`"}], "\n", 
 RowBox[{"<<", "NilssonLab`EMUTracing`"}], "\n", 
 RowBox[{"<<", "NilssonLab`OpenFLUX`"}]}], "Input",
 CellChangeTimes->{{3.8736027968317814`*^9, 3.873602810553677*^9}, {
   3.8736029592661905`*^9, 3.87360296547674*^9}, {3.873603092158718*^9, 
   3.8736030983175583`*^9}, 3.8736036452619596`*^9, 3.8737109222853355`*^9, 
   3.873792980544074*^9},ExpressionUUID->"ca7b0e43-1f8b-4cf5-b28a-\
91e9698c2524"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"ParentDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6889896930701766`*^9, 3.6889896996279516`*^9}, {
  3.856929109884263*^9, 3.8569291129591084`*^9}, {3.8732704820637503`*^9, 
  3.873270493622513*^9}, {3.8737196952330446`*^9, 
  3.873719700612359*^9}},ExpressionUUID->"b65a47f6-7471-48d6-ab5a-\
e8e5910d8834"],

Cell[BoxData["\<\"C:\\\\code\\\\liver-flux-models\\\\Models\\\\liverModel_2_\
openFluxExport\"\>"], "Output",
 CellChangeTimes->{
  3.856929113491742*^9, {3.873270489620056*^9, 3.873270493938694*^9}, 
   3.873374430573454*^9, 3.873597756739482*^9, 3.873597809823702*^9, 
   3.8736027423441844`*^9, 3.8736028546674356`*^9, 3.87360336519059*^9, 
   3.873604027138008*^9, 3.8736041541760406`*^9, 3.8736908086578226`*^9, 
   3.873690851855493*^9, 3.8736940269546576`*^9, 3.8736960329684305`*^9, 
   3.873717563696373*^9, 3.8737197010131235`*^9, {3.87378967606466*^9, 
   3.8737897035203733`*^9}, 3.873790941841673*^9, 3.8738605053698945`*^9, 
   3.873877148505517*^9, 
   3.875168525915042*^9},ExpressionUUID->"69cdfca0-9bdc-40b4-bc3b-\
cf64bfb3a39d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"modelName", "=", "\"\<liver-model-2\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.8569305055716453`*^9, 
  3.856930510570527*^9}},ExpressionUUID->"0a4a2b72-d411-4135-b290-\
918ccbade0a5"],

Cell[CellGroupData[{

Cell["Import model from database", "Section",
 CellChangeTimes->{{3.8569305263964157`*^9, 
  3.8569305290251107`*^9}},ExpressionUUID->"d44ab51e-cf64-4e55-b805-\
4a8ac541c16d"],

Cell[BoxData[
 RowBox[{"RefreshDBConnection", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8738771166081066`*^9, 
  3.8738771223442183`*^9}},ExpressionUUID->"e3b49ad9-16a6-430e-864f-\
f6bf3277bd59"],

Cell[CellGroupData[{

Cell["Get network from database", "Subsection",
 CellChangeTimes->{{3.499323805156*^9, 3.49932380977*^9}, {3.499326064519*^9, 
  3.499326073966*^9}, {3.5769029256772556`*^9, 3.576902928588256*^9}, {
  3.5794118898813744`*^9, 3.5794118915453744`*^9}, {3.615270075454768*^9, 
  3.6152700778147683`*^9}, {3.677582556005767*^9, 3.67758256086343*^9}, {
  3.6878432108826427`*^9, 3.6878432136162815`*^9}, {3.873602872128394*^9, 
  3.8736028732644625`*^9}},ExpressionUUID->"3770723a-dde8-4765-8de9-\
9a9615ab5e96"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"net", "=", 
  RowBox[{"NetworkFromDB", "[", "modelName", "]"}]}]], "Input",
 CellChangeTimes->{{3.499323834406*^9, 3.499323852743*^9}, {
   3.4994311919848804`*^9, 3.4994311920461206`*^9}, 3.4994550985229807`*^9, {
   3.5794119039713745`*^9, 3.5794119414663744`*^9}, {3.5794119780093746`*^9, 
   3.5794120134483747`*^9}, {3.5794123828283744`*^9, 
   3.5794124186673746`*^9}, {3.5794124544223747`*^9, 
   3.5794124708793745`*^9}, {3.5799318424875402`*^9, 
   3.5799320013645406`*^9}, {3.5799320323155403`*^9, 
   3.5799320359095407`*^9}, {3.5839284507735467`*^9, 
   3.5839284569801674`*^9}, {3.5975704220441537`*^9, 3.597570531043154*^9}, {
   3.5980802888304076`*^9, 3.598080335038028*^9}, 3.6775823640602674`*^9, 
   3.6857805170811443`*^9, {3.6857805707043943`*^9, 3.6857806699266443`*^9}, {
   3.6878432181247463`*^9, 3.687843224355844*^9}, {3.8108879867347364`*^9, 
   3.8108879907653008`*^9}, {3.8115774659162693`*^9, 3.811577468075926*^9}, {
   3.813060742147523*^9, 3.8130607469955883`*^9}, {3.8441438593466587`*^9, 
   3.8441438631393256`*^9}, {3.856930504651784*^9, 
   3.8569305141739655`*^9}},ExpressionUUID->"62eaa71f-d865-4f34-9fec-\
6be3d21003be"],

Cell[BoxData["\<\"<MetabolicNetwork, 89 reactions>\"\>"], "Output",
 CellChangeTimes->{
  3.677582365590087*^9, 3.677648593821422*^9, 3.6778217985042152`*^9, 
   3.678194164940657*^9, 3.6783712979655333`*^9, 3.6790428623493767`*^9, {
   3.6857786480506444`*^9, 3.685778658484394*^9}, 3.6857806298776445`*^9, {
   3.685780659965144*^9, 3.6857806704866447`*^9}, 3.6878432257030735`*^9, 
   3.687843629884431*^9, 3.6878604282878647`*^9, 3.6878615326129236`*^9, 
   3.687868504092718*^9, 3.6879478386841726`*^9, 3.687949460018469*^9, 
   3.6879496848719883`*^9, 3.687951234197369*^9, 3.687951276944138*^9, 
   3.6879513482842665`*^9, 3.687951400609828*^9, 3.687954436290655*^9, 
   3.6879550976088824`*^9, 3.688733261265664*^9, 3.688985231568944*^9, 
   3.692521843507619*^9, 3.8108879915528245`*^9, 3.810888239656397*^9, 
   3.810890391986615*^9, 3.810890546260832*^9, 3.81089073118051*^9, 
   3.8115763565457907`*^9, 3.8115774700197153`*^9, 3.811577762577687*^9, 
   3.8115778613372455`*^9, 3.8115813253015037`*^9, 3.8115896968903513`*^9, 
   3.8115904093018513`*^9, 3.811591530700432*^9, 3.8130607497149396`*^9, 
   3.8130609406695504`*^9, 3.8130610653399553`*^9, 3.813061205664857*^9, 
   3.813063465224098*^9, 3.8441438654798822`*^9, 3.8441444544372687`*^9, 
   3.8441447743134995`*^9, 3.844145002375251*^9, 3.844145162677668*^9, 
   3.844145274650807*^9, 3.8441453620740433`*^9, 3.844145460108758*^9, 
   3.8441455004849253`*^9, 3.844153026289584*^9, 3.844153278828453*^9, 
   3.844153477772729*^9, 3.8441535375045896`*^9, {3.844153575855307*^9, 
   3.8441536028833113`*^9}, {3.8441557898384857`*^9, 3.8441558176655283`*^9}, 
   3.844156193851218*^9, 3.8441562348931074`*^9, 3.844156352145376*^9, {
   3.8441564225468903`*^9, 3.844156425658987*^9}, 3.844158986820259*^9, 
   3.8441590263920574`*^9, 3.844159726736041*^9, 3.8441597925706716`*^9, 
   3.8441636271292677`*^9, 3.8441675567460938`*^9, 3.844167906355685*^9, 
   3.8559061231517706`*^9, {3.8559958327267437`*^9, 3.855995851298307*^9}, 
   3.855999479037511*^9, 3.8559995770275536`*^9, 3.856001248251252*^9, 
   3.856001985935531*^9, 3.8560021904204082`*^9, 3.8560851757533827`*^9, 
   3.856088349404881*^9, 3.8560890029137573`*^9, 3.8560896284434443`*^9, 
   3.85609001389332*^9, 3.8560925949393992`*^9, 3.8560929248119698`*^9, 
   3.856093136186307*^9, 3.856929118827602*^9, 3.8569305152422094`*^9, 
   3.8732705212950573`*^9, 3.8733744368991823`*^9, 3.8735978142461724`*^9, 
   3.873602759373424*^9, 3.8736028583257008`*^9, 3.8736033749522*^9, 
   3.873604032494879*^9, 3.8736041572221727`*^9, 3.8736908624317503`*^9, 
   3.8736940285779*^9, 3.873696036675448*^9, 3.87371757262868*^9, 
   3.8737197208624525`*^9, 3.8737897115560045`*^9, 3.87386051384079*^9, 
   3.8738771335731688`*^9, 
   3.875168531734987*^9},ExpressionUUID->"5c694eac-d5ea-4d33-8bfe-\
db3399203c7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"Stoichiometry", "[", "net", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8736033783024454`*^9, 
  3.8736033903508873`*^9}},ExpressionUUID->"708470fb-34e5-4b67-9296-\
914782c009bf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"104", ",", "89"}], "}"}]], "Output",
 CellChangeTimes->{3.873603390567148*^9, 3.8736040325794935`*^9, 
  3.873604157300342*^9, 3.873690862585214*^9, 3.8736940287447295`*^9, 
  3.8736960368775587`*^9, 3.873717572782065*^9, 3.8737197210333405`*^9, 
  3.8737897116406903`*^9, 3.8738605141004157`*^9, 3.87387713366154*^9, 
  3.875168531892845*^9},ExpressionUUID->"8a665f15-b296-4270-9de7-\
d0d42c66c2bc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get atom maps from database", "Subsection",
 CellChangeTimes->{{3.617872170201542*^9, 3.6178721746631703`*^9}, {
  3.6775825662857003`*^9, 3.6775825694595413`*^9}, {3.8735978542703223`*^9, 
  3.8735978584150085`*^9}, {3.8736028656082973`*^9, 
  3.873602868237415*^9}},ExpressionUUID->"dc68bb20-9723-4d84-838f-\
3d84883d2c01"],

Cell["Renumber atoms to get consecutive atom symbols a,b,c...", "Text",
 CellChangeTimes->{{3.6889858450113482`*^9, 3.688985855347926*^9}, {
  3.8569291491096635`*^9, 3.856929150308481*^9}, {3.8732709235782113`*^9, 
  3.8732709275407095`*^9}, {3.8736034060246115`*^9, 
  3.8736034298659487`*^9}},ExpressionUUID->"158db355-8cc4-4228-9645-\
47a64db369c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"atomMaps", "=", 
   RowBox[{"RemoveUnreachable", "[", 
    RowBox[{"net", ",", 
     RowBox[{"AtomMapsFromDB", "[", 
      RowBox[{"net", ",", 
       RowBox[{"{", "\"\<C\>\"", "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"atomMaps", "=", 
   RowBox[{"RenumberAtoms", "[", "atomMaps", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5771692167802677`*^9, 3.5771692171872673`*^9}, {
   3.577171238634268*^9, 3.5771712394412675`*^9}, 3.5771743414402676`*^9, 
   3.597847669695359*^9, 3.597849401247749*^9, 3.597908190884599*^9, 
   3.597909228741599*^9, 3.5979098719685993`*^9, 3.599046400289027*^9, 
   3.607159543903122*^9, {3.615640070382162*^9, 3.615640071944162*^9}, {
   3.6178707038284826`*^9, 3.617870704811282*^9}, {3.6213394493958855`*^9, 
   3.6213394601809635`*^9}, {3.646301404810319*^9, 3.6463014056823187`*^9}, 
   3.658140541949315*^9, {3.658487332799675*^9, 3.658487343377675*^9}, {
   3.6775825784648576`*^9, 3.677582579791875*^9}, 3.677582846595523*^9, {
   3.6778464234459257`*^9, 3.677846527833926*^9}, {3.677846624831726*^9, 
   3.677846630152326*^9}, {3.6878436940742283`*^9, 3.687843708239538*^9}, {
   3.6878437453216143`*^9, 3.687843747732848*^9}, {3.687843851890857*^9, 
   3.6878438532802663`*^9}, {3.6878443423429203`*^9, 3.6878443530087857`*^9}, 
   3.856929145837825*^9, 3.8736028640176992`*^9, 
   3.87360343258237*^9},ExpressionUUID->"67f5f1b2-5062-4a3a-85ce-\
06588743fc36"],

Cell["\<\
Consistency check, ensure that there are no broken paths on the atom level\
\>", "Text",
 CellChangeTimes->{{3.6180272494648237`*^9, 3.618027252697793*^9}, {
  3.6577946809957314`*^9, 
  3.6577947094123316`*^9}},ExpressionUUID->"0cf4909f-9fe1-47b4-b40a-\
00dbdf910fe4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CheckAtomMap", "[", "atomMaps", "]"}]], "Input",
 CellChangeTimes->{{3.618028122550089*^9, 3.618028127446579*^9}, 
   3.618037024228168*^9, 3.6180372948222246`*^9, {3.6775826540578346`*^9, 
   3.6775826584298906`*^9}, {3.677582858228673*^9, 3.677582858510477*^9}, 
   3.873602899101575*^9},ExpressionUUID->"55e7b4fb-44f2-41f0-b1bf-\
64bd01b24b82"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.6775828627421317`*^9, 3.6776486292709208`*^9, 3.677821812435194*^9, 
   3.6778465309227257`*^9, 3.6778466363455257`*^9, 3.677846668362526*^9, 
   3.6781942142446575`*^9, 3.6783713186365337`*^9, 3.6790428814708767`*^9, 
   3.685778714508644*^9, 3.6857807275021443`*^9, 3.6878437550995703`*^9, 
   3.687843855821119*^9, 3.6878443546118145`*^9, 3.6878604397454553`*^9, 
   3.6878615346263514`*^9, 3.687868531788159*^9, 3.687951414712241*^9, 
   3.687954452613248*^9, 3.687955124763873*^9, 3.688733269811414*^9, 
   3.6889853491493654`*^9, 3.6889858566492805`*^9, 3.688986376795706*^9, 
   3.6889865470631003`*^9, 3.6925221212558193`*^9, 3.8569291573587985`*^9, 
   3.873270931584852*^9, 3.873374687919634*^9, 3.873597824805133*^9, 
   3.8736028993860145`*^9, 3.8736034350631037`*^9, 3.873604032833317*^9, 
   3.8736041575543337`*^9, 3.8736908659856625`*^9, 3.873694030839372*^9, 
   3.8736960406885347`*^9, 3.873717577803116*^9, 3.873719727083314*^9, 
   3.8737897147225285`*^9, {3.873877110645605*^9, 3.87387713656979*^9}, 
   3.8751685378118677`*^9},ExpressionUUID->"3156f28c-3a17-4d50-9304-\
ae48ddc02dc7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get symmetry", "Subsection",
 CellChangeTimes->{{3.873690869320806*^9, 
  3.873690873720513*^9}},ExpressionUUID->"e11f6976-9335-45b7-95a0-\
b02f7d6d90d4"],

Cell[TextData[{
 "For Openflux, we encode symmetries directly in the atom map. This works \
only when symmetries can be expressed as equivalence classes over atoms: for \
an ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "51a83c59-855c-4967-bea5-9f7790162c28"],
 "-atom molecule A, partition the ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "40f419cf-9928-427a-b58f-f5341f21a0ff"],
 " atoms into equivalence classes. Then for any reaction producing A, for \
each equivalence class ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["a", "1"], ",", 
      SubscriptBox["a", "2"], ",", "..."}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"40435a81-812c-4b95-bd0f-e29fa8c9fc1a"],
 " of size ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "3648c158-a8c2-48e5-a644-8dbb14909c9f"],
 ", we replace each atom mapping ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], "\[Rule]", 
    SubscriptBox["a", "i"]}], TraditionalForm]],ExpressionUUID->
  "2557393f-4de5-453b-bdfa-82af32375464"],
 " with a \[OpenCurlyDoubleQuote]mixture\[CloseCurlyDoubleQuote] mapping ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "i"], "\[Rule]", 
      RowBox[{
       SubscriptBox["a", "1"], "/", "m"}]}], ",", 
     RowBox[{
      SubscriptBox["x", "i"], "\[Rule]", 
      RowBox[{
       SubscriptBox["a", "2"], "/", "m"}]}], ",", "..."}], "}"}], 
   TraditionalForm]],ExpressionUUID->"33afe8ab-e380-46ef-82bb-1a8f9abecdaa"],
 " so that atom ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "i"], TraditionalForm]],ExpressionUUID->
  "dbeacc25-7269-4e60-a13a-5745f24cfab9"],
 " is \[OpenCurlyDoubleQuote]divided\[CloseCurlyDoubleQuote] equally over the \
atoms in ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]],ExpressionUUID->
  "7f0e7396-7431-42e0-9060-a80255f145aa"],
 "."
}], "Text",
 CellChangeTimes->{{3.8736909989625535`*^9, 3.873691325970395*^9}, {
  3.873691557942309*^9, 3.873691840122399*^9}, {3.8737099576011906`*^9, 
  3.873709958905178*^9}},ExpressionUUID->"106bd811-7982-497a-b812-\
3dc57018a997"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"symmetry", "=", 
  RowBox[{"GetSymmetryMap", "[", "atomMaps", "]"}]}]], "Input",
 CellChangeTimes->{{3.873690874958253*^9, 3.8736908849378843`*^9}, 
   3.873718896702818*^9},ExpressionUUID->"80be1280-9260-47eb-96e1-\
fcc2c42616c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"fum\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"succ\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8736908866004953`*^9, 3.873694035893544*^9, 3.873696048260955*^9, {
   3.873713963492979*^9, 3.873713980161469*^9}, 3.873717581281123*^9, 
   3.873718841895447*^9, 3.8737188995993004`*^9, {3.873719527640868*^9, 
   3.8737195457037835`*^9}, 3.8737196022600374`*^9, 3.8737197327000732`*^9, 
   3.8737897161605177`*^9, 3.8738771390969777`*^9, 
   3.8751686368187513`*^9},ExpressionUUID->"5945bc92-5a1f-49e0-a4a9-\
330d006fa730"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export model in Openflux format", "Section",
 CellChangeTimes->{{3.6889853613993473`*^9, 3.688985371688672*^9}, {
  3.856929235058355*^9, 3.8569292352917595`*^9}, {3.856930441772032*^9, 
  3.8569304420512843`*^9}, {3.873270970581813*^9, 
  3.873270972109849*^9}},ExpressionUUID->"6a448d12-db75-4c74-8cae-\
7a1a2b07cba7"],

Cell["We need to specify measured metabolites (targets)", "Text",
 CellChangeTimes->{{3.873277796820483*^9, 3.8732778091398525`*^9}, {
  3.873603033941075*^9, 
  3.873603074407507*^9}},ExpressionUUID->"612778be-40c4-447d-980e-\
dd686bf1143c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"measuredMet", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<glc-D\>\"", ",", "\"\<ala-L\>\"", ",", "\"\<arg-L\>\"", ",", 
     "\"\<asp-L\>\"", ",", "\"\<gln-L\>\"", ",", "\"\<glu-L\>\"", ",", 
     "\"\<gly\>\"", ",", "\"\<ser-L\>\"", ",", "\"\<mal-L\>\"", ",", 
     "\"\<g3p\>\"", ",", "\"\<acrn\>\"", ",", "\"\<glyc3p\>\"", ",", 
     "\"\<orn\>\"", ",", "\"\<citr-L\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873277762647794*^9, 
  3.8732777663484097`*^9}},ExpressionUUID->"75bc5316-8510-44a4-ba98-\
9a8a8c345e6b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"targets", "=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"MetaboliteEMUs", "[", "atomMaps", "]"}], ",", 
    RowBox[{"EMU", "[", 
     RowBox[{
      RowBox[{"Metabolite", "[", 
       RowBox[{
        RowBox[{"Alternatives", "@@", "measuredMet"}], ",", "__"}], "]"}], 
      ",", "__"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.873276355994095*^9, 3.87327638896634*^9}, {
   3.8732764307496915`*^9, 3.8732764319384007`*^9}, {3.8732777582286234`*^9, 
   3.8732777879649897`*^9}, 
   3.8736031061894226`*^9},ExpressionUUID->"5b4be94a-cee1-4ac5-9cb4-\
ce796090a170"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"<acrn_c{(12)}>\"\>", ",", "\<\"<acrn_m{(12)}>\"\>", 
   ",", "\<\"<ala-L_c{(123)}>\"\>", ",", "\<\"<arg-L_c{(123456)}>\"\>", 
   ",", "\<\"<asp-L_c{(1234)}>\"\>", ",", "\<\"<asp-L_m{(1234)}>\"\>", 
   ",", "\<\"<citr-L_c{(123456)}>\"\>", ",", "\<\"<citr-L_m{(123456)}>\"\>", 
   ",", "\<\"<g3p_c{(123)}>\"\>", ",", "\<\"<glc-D_c{(123456)}>\"\>", 
   ",", "\<\"<glc-D_r{(123456)}>\"\>", ",", "\<\"<gln-L_c{(12345)}>\"\>", 
   ",", "\<\"<gln-L_m{(12345)}>\"\>", ",", "\<\"<glu-L_c{(12345)}>\"\>", 
   ",", "\<\"<glu-L_m{(12345)}>\"\>", ",", "\<\"<gly_c{(12)}>\"\>", 
   ",", "\<\"<glyc3p_c{(123)}>\"\>", ",", "\<\"<mal-L_c{(1234)}>\"\>", 
   ",", "\<\"<mal-L_m{(1234)}>\"\>", ",", "\<\"<orn_c{(12345)}>\"\>", 
   ",", "\<\"<orn_m{(12345)}>\"\>", ",", "\<\"<ser-L_c{(123)}>\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.873276389213661*^9, 3.8732764444412904`*^9, 
  3.8732777886714797`*^9, 3.8733753091846066`*^9, 3.8733778655414295`*^9, 
  3.8735999161372623`*^9, 3.873603110296466*^9, 3.8736034456802835`*^9, 
  3.8736040362252293`*^9, 3.873604160080714*^9, 3.873692648812298*^9, 
  3.8737178315676527`*^9, 3.873719620917324*^9, 3.873790938943777*^9, 
  3.8738771422778683`*^9, 
  3.8751686394265757`*^9},ExpressionUUID->"2ea660aa-e009-432d-8a16-\
8b122343b777"]
}, Open  ]],

Cell[CellGroupData[{

Cell["With symmetry", "Subsection",
 CellChangeTimes->{{3.8751685520634604`*^9, 3.8751685550277967`*^9}, 
   3.8751686452759304`*^9},ExpressionUUID->"bbd33efe-210e-43da-8138-\
555a5736fa14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OpenFLUXExport", "[", 
  RowBox[{
   RowBox[{"modelName", "<>", "\"\<_openflux.txt\>\""}], ",", "net", ",", 
   "atomMaps", ",", "symmetry", ",", "targets"}], "]"}]], "Input",
 CellChangeTimes->{{3.8736031915180416`*^9, 3.873603278827753*^9}, {
  3.8737178516574507`*^9, 
  3.873717852907487*^9}},ExpressionUUID->"2ad246cb-c694-4f32-b930-\
1732bb71d422"],

Cell[BoxData["\<\"liver-model-2_openflux.txt\"\>"], "Output",
 CellChangeTimes->{
  3.8736032803869233`*^9, 3.8736034484338408`*^9, 3.873603650223855*^9, 
   3.8736037429153347`*^9, 3.8736038551681585`*^9, 3.8736040378150997`*^9, 
   3.873604076951941*^9, 3.873604110803437*^9, 3.873604160312462*^9, 
   3.8736926524628506`*^9, {3.873717836342861*^9, 3.873717854186284*^9}, 
   3.873717918712034*^9, 3.8737180067411633`*^9, 3.8737185320735044`*^9, 
   3.873719621048809*^9, 3.8737197849835815`*^9, 3.87379094390279*^9, 
   3.8738771505058947`*^9},ExpressionUUID->"29497309-ab72-442f-8856-\
a64071d9a016"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without symmetry", "Subsection",
 CellChangeTimes->{{3.8751685520634604`*^9, 3.8751685550277967`*^9}, {
  3.8751686452759304`*^9, 3.875168651176104*^9}, {3.875168718285984*^9, 
  3.8751687237544346`*^9}},ExpressionUUID->"ae8e68e8-343d-4679-b442-\
c11a6fe07a35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OpenFLUXExport", "[", 
  RowBox[{
   RowBox[{"modelName", "<>", "\"\<_nosymmetry_openflux.txt\>\""}], ",", 
   "net", ",", "atomMaps", ",", 
   RowBox[{"{", "}"}], ",", "targets"}], "]"}]], "Input",
 CellChangeTimes->{{3.8736031915180416`*^9, 3.873603278827753*^9}, {
  3.8737178516574507`*^9, 3.873717852907487*^9}, {3.8751687296133237`*^9, 
  3.8751687404478345`*^9}},ExpressionUUID->"fc834c1b-108e-4086-b9f3-\
1592bc26949c"],

Cell[BoxData["\<\"liver-model-2_nosymmetry_openflux.txt\"\>"], "Output",
 CellChangeTimes->{
  3.8736032803869233`*^9, 3.8736034484338408`*^9, 3.873603650223855*^9, 
   3.8736037429153347`*^9, 3.8736038551681585`*^9, 3.8736040378150997`*^9, 
   3.873604076951941*^9, 3.873604110803437*^9, 3.873604160312462*^9, 
   3.8736926524628506`*^9, {3.873717836342861*^9, 3.873717854186284*^9}, 
   3.873717918712034*^9, 3.8737180067411633`*^9, 3.8737185320735044`*^9, 
   3.873719621048809*^9, 3.8737197849835815`*^9, 3.87379094390279*^9, 
   3.8738771505058947`*^9, 
   3.87516874236436*^9},ExpressionUUID->"2e73de43-6007-41df-8b18-\
d2e64498cd72"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{939, 954},
WindowMargins->{{0, Automatic}, {Automatic, 10}},
Magnification:>0.95 Inherited,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 331, 5, 99, "Title", "ExpressionUUID" -> \
"5a16511f-8798-4118-97b0-a3784717dfa2"],
Cell[914, 29, 278, 6, 30, "Text", "ExpressionUUID" -> \
"ff575bd2-4f28-444b-9d35-3f8588b72669"],
Cell[1195, 37, 282, 6, 30, "Text", "ExpressionUUID" -> \
"627f5246-9c2b-4e7d-a06b-3a7c721831e0"],
Cell[1480, 45, 521, 9, 84, "Input", "ExpressionUUID" -> \
"ca7b0e43-1f8b-4cf5-b28a-91e9698c2524"],
Cell[CellGroupData[{
Cell[2026, 58, 427, 8, 29, "Input", "ExpressionUUID" -> \
"b65a47f6-7471-48d6-ab5a-e8e5910d8834"],
Cell[2456, 68, 747, 12, 29, "Output", "ExpressionUUID" -> \
"69cdfca0-9bdc-40b4-bc3b-cf64bfb3a39d"]
}, Open  ]],
Cell[3218, 83, 223, 5, 29, "Input", "ExpressionUUID" -> \
"0a4a2b72-d411-4135-b290-918ccbade0a5"],
Cell[CellGroupData[{
Cell[3466, 92, 175, 3, 68, "Section", "ExpressionUUID" -> \
"d44ab51e-cf64-4e55-b805-4a8ac541c16d"],
Cell[3644, 97, 197, 4, 29, "Input", "ExpressionUUID" -> \
"e3b49ad9-16a6-430e-864f-f6bf3277bd59"],
Cell[CellGroupData[{
Cell[3866, 105, 507, 7, 46, "Subsection", "ExpressionUUID" -> \
"3770723a-dde8-4765-8de9-9a9615ab5e96"],
Cell[CellGroupData[{
Cell[4398, 116, 1186, 19, 29, "Input", "ExpressionUUID" -> \
"62eaa71f-d865-4f34-9fec-6be3d21003be"],
Cell[5587, 137, 2833, 40, 29, "Output", "ExpressionUUID" -> \
"5c694eac-d5ea-4d33-8bfe-db3399203c7d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8457, 182, 235, 5, 29, "Input", "ExpressionUUID" -> \
"708470fb-34e5-4b67-9296-914782c009bf"],
Cell[8695, 189, 440, 8, 29, "Output", "ExpressionUUID" -> \
"8a665f15-b296-4270-9de7-d0d42c66c2bc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9184, 203, 331, 5, 46, "Subsection", "ExpressionUUID" -> \
"dc68bb20-9723-4d84-838f-3d84883d2c01"],
Cell[9518, 210, 353, 5, 30, "Text", "ExpressionUUID" -> \
"158db355-8cc4-4228-9645-47a64db369c2"],
Cell[9874, 217, 1459, 26, 48, "Input", "ExpressionUUID" -> \
"67f5f1b2-5062-4a3a-85ce-06588743fc36"],
Cell[11336, 245, 279, 6, 30, "Text", "ExpressionUUID" -> \
"0cf4909f-9fe1-47b4-b40a-00dbdf910fe4"],
Cell[CellGroupData[{
Cell[11640, 255, 371, 6, 29, "Input", "ExpressionUUID" -> \
"55e7b4fb-44f2-41f0-b1bf-64bd01b24b82"],
Cell[12014, 263, 1176, 18, 29, "Output", "ExpressionUUID" -> \
"3156f28c-3a17-4d50-9304-ae48ddc02dc7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13239, 287, 160, 3, 46, "Subsection", "ExpressionUUID" -> \
"e11f6976-9335-45b7-95a0-b02f7d6d90d4"],
Cell[13402, 292, 2184, 61, 87, "Text", "ExpressionUUID" -> \
"106bd811-7982-497a-b812-3dc57018a997"],
Cell[CellGroupData[{
Cell[15611, 357, 255, 5, 29, "Input", "ExpressionUUID" -> \
"80be1280-9260-47eb-96e1-fcc2c42616c4"],
Cell[15869, 364, 926, 24, 29, "Output", "ExpressionUUID" -> \
"5945bc92-5a1f-49e0-a4a9-330d006fa730"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16856, 395, 326, 5, 68, "Section", "ExpressionUUID" -> \
"6a448d12-db75-4c74-8cae-7a1a2b07cba7"],
Cell[17185, 402, 242, 4, 30, "Text", "ExpressionUUID" -> \
"612778be-40c4-447d-980e-dd686bf1143c"],
Cell[17430, 408, 566, 12, 48, "Input", "ExpressionUUID" -> \
"75bc5316-8510-44a4-ba98-9a8a8c345e6b"],
Cell[CellGroupData[{
Cell[18021, 424, 606, 15, 29, "Input", "ExpressionUUID" -> \
"5b4be94a-cee1-4ac5-9cb4-ce796090a170"],
Cell[18630, 441, 1310, 21, 84, "Output", "ExpressionUUID" -> \
"2ea660aa-e009-432d-8a16-8b122343b777"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19977, 467, 190, 3, 46, "Subsection", "ExpressionUUID" -> \
"bbd33efe-210e-43da-8138-555a5736fa14"],
Cell[CellGroupData[{
Cell[20192, 474, 378, 8, 29, "Input", "ExpressionUUID" -> \
"2ad246cb-c694-4f32-b930-1732bb71d422"],
Cell[20573, 484, 604, 9, 29, "Output", "ExpressionUUID" -> \
"29497309-ab72-442f-8856-a64071d9a016"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21226, 499, 267, 4, 46, "Subsection", "ExpressionUUID" -> \
"ae8e68e8-343d-4679-b442-c11a6fe07a35"],
Cell[CellGroupData[{
Cell[21518, 507, 451, 9, 29, "Input", "ExpressionUUID" -> \
"fc834c1b-108e-4086-b9f3-1592bc26949c"],
Cell[21972, 518, 640, 10, 29, "Output", "ExpressionUUID" -> \
"2e73de43-6007-41df-8b18-d2e64498cd72"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

